<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.5.0/chart.min.js"></script>
    <title>Hello, world!</title>
  </head>
  <body>
      <div class="container-fluid">
        <div class="row">
            
            <div class = "col-sm-12">
                <div>
                    <canvas id="myChart"></canvas>
                  </div>
                   

            </div>

            <div class = "col-sm-12">
                <div>
                    <canvas id="SPDRMinChange"></canvas>
                  </div>
                   

            </div> 


        </div>

        


      </div>
    

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    
    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    -->
















  </body>
</html>

<script>


$( document ).ready(function() {
    fetch('/Diff')
            .then(function (response) {
            return response.json() // แปลงข้อมูลที่ได้เป็น json
            })
            .then(function (datas) {


            // var chartColors = {
            //                     red: 'rgb(255, 99, 132)',
            //                     blue: 'rgb(54, 162, 235)',
            //                     green : 'rgb(46,169,158)'
            //                     };

            // var ctx = document.getElementById("myChart").getContext("2d");
            // var myChart = new Chart(ctx, {
            // type: 'bar',
            // data: {
            //     labels: datas.Dates,
            //     datasets: [{
            //     label: 'ค่าการเปลี่ยนแปลงของการถือครองทองคำของกองทุน SPDR (Tonnes)',
            //     backgroundColor: [chartColors.green,chartColors.green,chartColors.green,chartColors.green,chartColors.green,chartColors.green,chartColors.green,chartColors.green]
                    
            //     ,
            //     data: datas.Value
            //     }],
            // }
            // });

            // var colorChangeValue = 0; //set this to whatever is the deciding color change value
            // var dataset = myChart.data.datasets[0];
            // for (var i = 0; i < dataset.data.length; i++) {
            // if (dataset.data[i] < colorChangeValue) {
            //     dataset.backgroundColor[i] = chartColors.red;
            // }
            // }
            // myChart.update();


            /////////////////////

            
			const data = datas.Value;
			const colours = data.map((value) => value < 0 ? 'rgb(255, 99, 132,0.7)' : 'rgb(75, 192, 192,0.7)');
			var ctx = document.getElementById('SPDRMinChange').getContext('2d');
			var SPDRMinChange = new Chart(ctx, {
				type: 'bar',
				data: {
					labels: datas.Dates,
					datasets: [
						{
							label: 'Tonnes of Gold',
							data: data,
							backgroundColor: colours,
							borderColor: colours,
							borderWidth: 2
						}
					]
				},
				options: {
					// responsive: true,
					// title: {
					// 	display: true,
					// 	text: 'ค่าการเปลี่ยนแปลงของการถือครองทองคำของกองทุน SPDR (Tonnes)'
					// },
					// tooltips: {
					// 	mode: 'index',
					// 	intersect: true
					// },
					legend: {
						display: false,
                        
					}
				}
			});

            var ctx = document.getElementById("myChart").getContext('2d');

            var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: datas.Dates,
                datasets: [{
                    labels: "This will be hide",
                    data: data,
                    backgroundColor: colours
                }]
            },
            options: {
                legend: {
                    display: false //This will do the task
                }
            }
            });
			






            });
    



        })

</script>